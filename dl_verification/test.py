import datetime

from mysql.connector import MySQLConnection

from python_mysql_dbconfig import read_db_config

print(datetime.date.today().strftime("%B, %Y"))

dbconfig = read_db_config()
conn = MySQLConnection(**dbconfig)
cursor = conn.cursor()

hits = """select count(id) as Count  from driving_license_detail dld WHERE month(created_at) = month(
CURRENT_DATE()) and error <> "Invalid driving license format" ;"""
cursor.execute(hits)
count_total_api_hits = cursor.fetchall()
print(count_total_api_hits[0][0])

invalid_dl = """select count(id) as Count  from driving_license_detail dld WHERE date(created_at) = CURRENT_DATE() 
and error = "Invalid driving license format" ;"""
cursor.execute(invalid_dl)
count_total = cursor.fetchall()
print(count_total[0][0])

vehicle_location_object = {'success': True, 'requestId': 'fleet-db451679-a1b8-419d-a35c-5ce9cf43d9b4',
                           'data': {'vehicleNo': 'DL51GD3467', 'soc': 100.0, 'lastRefreshTime': '05-06-2024 14:10:22',
                                    'estimatedRange': 79.0, 'recentMileageFactor': 0.7915422993492407,
                                    'mileageFactor': 0.79, 'distanceCovered': 0.0, 'odometer': 36506.1,
                                    'odometerRefreshTime': '05-06-2024 14:10:22', 'current': -1.0,
                                    'mfStaticLastOdometer': 36490.1, 'mfStaticLastOdometerTime': '05-06-2024 01:31:41',
                                    'mfStaticChargeCycles': 461, 'mfStaticChargeCyclesTime': '05-06-2024 01:31:41',
                                    'mfStaticFlag': True, 'lastSeenlatitude': None, 'lastSeenlongitude': None,
                                    'lastSeenSpeed': None, 'lastSeenTime': None, 'vehicleType': 'THREE_WHEELER',
                                    'motorTemperature': 56.0, 'controllerTemperature': 65.0,
                                    'accelerationPedalPosition': 0.0, 'chargeCycle': 462,
                                    'lastChargeCycleRefreshTime': None, 'stateOfHealth': 99.24, 'keyOnIndicator': 1,
                                    'gearState': 1, 'vehicleConfig': None, 'vehicleSpeed': 0, 'torque': None,
                                    'icPc': None, 'faultCode2': None, 'tripDistance': None, 'iaPc': None, 'dte': None,
                                    'evMileage': None, 'softwareChecksum': None, 'chargerStatus': None,
                                    'ioState3': None, 'ibPc': None, 'bv12': None, 'shaftSpeed': None, 'TqDemand': None,
                                    'wheelPower': None, 'motorConfig': None, 'faultCode': None, 'brakePedal': None,
                                    'batteryCurrent': None, 'batteryVoltage': 57.7, 'batteryFaultStatus': 0,
                                    'chargingTimeSeconds': 0, 'controllerFaultStatus': None, 'coordinatesMap': {
                                   '2024-06-05T00:10:17': {'latitude': 28.579815, 'longitude': 77.25465},
                                   '2024-06-05T00:11:13': {'latitude': 28.579952, 'longitude': 77.25453},
                                   '2024-06-05T00:11:25': {'latitude': 28.57978, 'longitude': 77.25477},
                                   '2024-06-05T00:13:04': {'latitude': 28.579668, 'longitude': 77.254906},
                                   '2024-06-05T00:14:04': {'latitude': 28.579662, 'longitude': 77.25498},
                                   '2024-06-05T00:14:56': {'latitude': 28.579546, 'longitude': 77.25503},
                                   '2024-06-05T00:15:52': {'latitude': 28.578964, 'longitude': 77.25503},
                                   '2024-06-05T00:16:48': {'latitude': 28.578411, 'longitude': 77.255486},
                                   '2024-06-05T00:18:12': {'latitude': 28.577059, 'longitude': 77.25639},
                                   '2024-06-05T00:19:08': {'latitude': 28.57623, 'longitude': 77.2555},
                                   '2024-06-05T00:20:04': {'latitude': 28.574697, 'longitude': 77.25643},
                                   '2024-06-05T00:21': {'latitude': 28.576447, 'longitude': 77.255264},
                                   '2024-06-05T00:21:56': {'latitude': 28.579193, 'longitude': 77.253174},
                                   '2024-06-05T00:22:52': {'latitude': 28.582226, 'longitude': 77.25165},
                                   '2024-06-05T00:23:48': {'latitude': 28.583595, 'longitude': 77.250626},
                                   '2024-06-05T00:25:12': {'latitude': 28.586662, 'longitude': 77.248024},
                                   '2024-06-05T00:26:08': {'latitude': 28.588959, 'longitude': 77.24651},
                                   '2024-06-05T00:26:39': {'latitude': 28.589409, 'longitude': 77.24626},
                                   '2024-06-05T00:28:04': {'latitude': 28.589407, 'longitude': 77.24625},
                                   '2024-06-05T00:39:28': {'latitude': 28.589455, 'longitude': 77.24622},
                                   '2024-06-05T00:43:02': {'latitude': 28.589455, 'longitude': 77.2462},
                                   '2024-06-05T00:44:02': {'latitude': 28.589455, 'longitude': 77.24621},
                                   '2024-06-05T00:44:29': {'latitude': 28.589447, 'longitude': 77.24615},
                                   '2024-06-05T00:46:34': {'latitude': 28.589455, 'longitude': 77.24615},
                                   '2024-06-05T00:50:19': {'latitude': 28.589476, 'longitude': 77.246155},
                                   '2024-06-05T00:50:47': {'latitude': 28.590654, 'longitude': 77.2454},
                                   '2024-06-05T00:52:11': {'latitude': 28.596258, 'longitude': 77.24135},
                                   '2024-06-05T00:53:07': {'latitude': 28.600393, 'longitude': 77.2386},
                                   '2024-06-05T00:54:03': {'latitude': 28.60394, 'longitude': 77.23623},
                                   '2024-06-05T00:54:59': {'latitude': 28.608894, 'longitude': 77.23347},
                                   '2024-06-05T00:55:55': {'latitude': 28.610588, 'longitude': 77.228745},
                                   '2024-06-05T00:57:19': {'latitude': 28.616276, 'longitude': 77.22473},
                                   '2024-06-05T00:58:15': {'latitude': 28.619282, 'longitude': 77.21988},
                                   '2024-06-05T00:59:11': {'latitude': 28.621515, 'longitude': 77.21566},
                                   '2024-06-05T01:00:07': {'latitude': 28.624098, 'longitude': 77.2116},
                                   '2024-06-05T01:01:03': {'latitude': 28.626528, 'longitude': 77.206055},
                                   '2024-06-05T01:01:59': {'latitude': 28.624247, 'longitude': 77.20072},
                                   '2024-06-05T01:03:23': {'latitude': 28.62608, 'longitude': 77.196556},
                                   '2024-06-05T01:04:19': {'latitude': 28.628794, 'longitude': 77.19162},
                                   '2024-06-05T01:04:47': {'latitude': 28.631382, 'longitude': 77.19034},
                                   '2024-06-05T01:07:07': {'latitude': 28.636684, 'longitude': 77.1833},
                                   '2024-06-05T01:07:35': {'latitude': 28.637934, 'longitude': 77.181046},
                                   '2024-06-05T01:08:03': {'latitude': 28.639368, 'longitude': 77.178444},
                                   '2024-06-05T01:09:55': {'latitude': 28.644888, 'longitude': 77.16935},
                                   '2024-06-05T01:12:15': {'latitude': 28.651316, 'longitude': 77.15686},
                                   '2024-06-05T01:13:11': {'latitude': 28.650312, 'longitude': 77.15565},
                                   '2024-06-05T01:14:07': {'latitude': 28.650307, 'longitude': 77.15565},
                                   '2024-06-05T01:14:35': {'latitude': 28.650307, 'longitude': 77.15565},
                                   '2024-06-05T01:15:13': {'latitude': 28.650309, 'longitude': 77.15568},
                                   '2024-06-05T01:24:23': {'latitude': 28.650301, 'longitude': 77.15568},
                                   '2024-06-05T01:36:03': {'latitude': 28.650301, 'longitude': 77.155685},
                                   '2024-06-05T01:43:27': {'latitude': 28.650293, 'longitude': 77.15569},
                                   '2024-06-05T01:54:33': {'latitude': 28.650303, 'longitude': 77.15567},
                                   '2024-06-05T02:01:23': {'latitude': 28.650314, 'longitude': 77.15564},
                                   '2024-06-05T02:32:21': {'latitude': 28.650373, 'longitude': 77.15569},
                                   '2024-06-05T02:32:31': {'latitude': 28.650368, 'longitude': 77.15569},
                                   '2024-06-05T03:03:42': {'latitude': 28.650385, 'longitude': 77.15569},
                                   '2024-06-05T03:34:49': {'latitude': 28.650362, 'longitude': 77.15568},
                                   '2024-06-05T04:06:01': {'latitude': 28.65032, 'longitude': 77.15569},
                                   '2024-06-05T04:37:02': {'latitude': 28.650387, 'longitude': 77.15568},
                                   '2024-06-05T05:08:03': {'latitude': 28.650295, 'longitude': 77.15563},
                                   '2024-06-05T05:39:23': {'latitude': 28.650316, 'longitude': 77.155685},
                                   '2024-06-05T06:10:35': {'latitude': 28.650381, 'longitude': 77.15562},
                                   '2024-06-05T06:41:36': {'latitude': 28.650263, 'longitude': 77.15564},
                                   '2024-06-05T07:14:23': {'latitude': 28.6503, 'longitude': 77.15564},
                                   '2024-06-05T07:45:39': {'latitude': 28.650303, 'longitude': 77.155685},
                                   '2024-06-05T08:16:40': {'latitude': 28.650337, 'longitude': 77.15569},
                                   '2024-06-05T08:47:39': {'latitude': 28.650373, 'longitude': 77.15569},
                                   '2024-06-05T08:47:49': {'latitude': 28.650368, 'longitude': 77.15568},
                                   '2024-06-05T09:18:44': {'latitude': 28.650414, 'longitude': 77.15563},
                                   '2024-06-05T09:54:17': {'latitude': 28.650341, 'longitude': 77.15566},
                                   '2024-06-05T10:25:39': {'latitude': 28.650301, 'longitude': 77.15565},
                                   '2024-06-05T11:05:25': {'latitude': 28.650333, 'longitude': 77.155594},
                                   '2024-06-05T11:53:59': {'latitude': 28.650341, 'longitude': 77.15561},
                                   '2024-06-05T12:46:27': {'latitude': 28.65032, 'longitude': 77.15566},
                                   '2024-06-05T13:09:49': {'latitude': 28.650322, 'longitude': 77.15566},
                                   '2024-06-05T13:10:32': {'latitude': 28.650257, 'longitude': 77.15561},
                                   '2024-06-05T13:16:40': {'latitude': 28.650297, 'longitude': 77.15565},
                                   '2024-06-05T13:27:46': {'latitude': 28.650297, 'longitude': 77.15565},
                                   '2024-06-05T13:32:19': {'latitude': 28.650297, 'longitude': 77.15565},
                                   '2024-06-05T13:33:15': {'latitude': 28.650335, 'longitude': 77.15567},
                                   '2024-06-05T13:34:11': {'latitude': 28.65033, 'longitude': 77.15569},
                                   '2024-06-05T13:35:07': {'latitude': 28.650326, 'longitude': 77.1557},
                                   '2024-06-05T13:36:31': {'latitude': 28.650328, 'longitude': 77.15569},
                                   '2024-06-05T13:37:27': {'latitude': 28.65033, 'longitude': 77.15569},
                                   '2024-06-05T13:38:23': {'latitude': 28.650331, 'longitude': 77.15569},
                                   '2024-06-05T13:39:19': {'latitude': 28.650331, 'longitude': 77.155685},
                                   '2024-06-05T13:40:15': {'latitude': 28.650328, 'longitude': 77.155685},
                                   '2024-06-05T13:41:11': {'latitude': 28.650326, 'longitude': 77.15568},
                                   '2024-06-05T13:42:07': {'latitude': 28.650326, 'longitude': 77.15568},
                                   '2024-06-05T13:43:31': {'latitude': 28.650333, 'longitude': 77.15568},
                                   '2024-06-05T13:44:27': {'latitude': 28.650337, 'longitude': 77.15568},
                                   '2024-06-05T13:45:23': {'latitude': 28.650341, 'longitude': 77.15568},
                                   '2024-06-05T13:46:19': {'latitude': 28.650341, 'longitude': 77.15568},
                                   '2024-06-05T13:47:15': {'latitude': 28.650343, 'longitude': 77.15568},
                                   '2024-06-05T13:48:11': {'latitude': 28.650341, 'longitude': 77.15568},
                                   '2024-06-05T13:49:07': {'latitude': 28.650337, 'longitude': 77.15568},
                                   '2024-06-05T13:50:31': {'latitude': 28.650333, 'longitude': 77.15568},
                                   '2024-06-05T13:50:59': {'latitude': 28.650333, 'longitude': 77.15568},
                                   '2024-06-05T13:52:23': {'latitude': 28.650335, 'longitude': 77.15567},
                                   '2024-06-05T13:53:19': {'latitude': 28.650335, 'longitude': 77.15567},
                                   '2024-06-05T13:54:15': {'latitude': 28.65034, 'longitude': 77.15567},
                                   '2024-06-05T13:55:11': {'latitude': 28.65034, 'longitude': 77.15567},
                                   '2024-06-05T13:56:35': {'latitude': 28.650341, 'longitude': 77.15567},
                                   '2024-06-05T13:57:31': {'latitude': 28.650341, 'longitude': 77.15567},
                                   '2024-06-05T13:58:27': {'latitude': 28.65034, 'longitude': 77.15567},
                                   '2024-06-05T13:59:23': {'latitude': 28.650337, 'longitude': 77.15566},
                                   '2024-06-05T14:00:19': {'latitude': 28.650337, 'longitude': 77.15566},
                                   '2024-06-05T14:01:15': {'latitude': 28.65034, 'longitude': 77.15566},
                                   '2024-06-05T14:02:11': {'latitude': 28.650343, 'longitude': 77.155655},
                                   '2024-06-05T14:03:35': {'latitude': 28.650352, 'longitude': 77.155655},
                                   '2024-06-05T14:04:31': {'latitude': 28.650354, 'longitude': 77.155655},
                                   '2024-06-05T14:05:27': {'latitude': 28.650356, 'longitude': 77.155655},
                                   '2024-06-05T14:06:23': {'latitude': 28.650356, 'longitude': 77.15565},
                                   '2024-06-05T14:07:19': {'latitude': 28.650356, 'longitude': 77.15565},
                                   '2024-06-05T14:08:15': {'latitude': 28.650356, 'longitude': 77.15565},
                                   '2024-06-05T14:09:11': {'latitude': 28.650358, 'longitude': 77.15565},
                                   '2024-06-05T14:10:35': {'latitude': 28.65036, 'longitude': 77.15564},
                                   '2024-06-05T14:10:50': {'latitude': 28.65036, 'longitude': 77.15565},
                                   '2024-06-05T14:12:10': {'latitude': 28.650364, 'longitude': 77.15565},
                                   '2024-06-05T14:24:39': {'latitude': 28.650362, 'longitude': 77.15567},
                                   '2024-06-05T14:30:41': {'latitude': 28.650364, 'longitude': 77.15568},
                                   '2024-06-05T14:42:04': {'latitude': 28.650364, 'longitude': 77.155655},
                                   '2024-06-05T14:49:15': {'latitude': 28.65037, 'longitude': 77.155655},
                                   '2024-06-05T15:01:51': {'latitude': 28.650375, 'longitude': 77.155655},
                                   '2024-06-05T15:33:05': {'latitude': 28.650354, 'longitude': 77.155685}},
                                    'tqDemand': None}}
