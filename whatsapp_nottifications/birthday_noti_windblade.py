import json
from json import dumps
import requests
import time
from httplib2 import Http
from mysql.connector import MySQLConnection

from python_mysql_dbconfig import read_db_config


class BirthdayWhatsAppWindblade:
    def get_drivers_detail(self):
        dbconfig = read_db_config()
        conn = MySQLConnection(**dbconfig)
        cursor = conn.cursor()
        print("Connection established")
        cursor.execute(
            "SELECT tud.FLD_USER_ID, tud.FLD_LOGIN_NAME, tld.FLD_LOCATION_ID, tld.FLD_LOCATION_NAME FROM "
            "TBL_PROFILE_DETAILS tpd INNER JOIN TBL_USER_DETAILS tud ON tud.FLD_USER_ID = tpd.FLD_USER_ID "
            "inner join TBL_DRIVER_DETAILS tdd on tdd.FLD_DRIVER_USER_ID = tud.FLD_USER_ID "
            "inner join TBL_LOCATION_DETAILS tld on tld.FLD_LOCATION_ID  = tdd.FLD_OPERATING_CITY_ID  WHERE month("
            "tpd.FLD_DATE_OF_BIRTH) = month(CURRENT_DATE()) and  DAY(tpd.FLD_DATE_OF_BIRTH) = DAY( "
            "CURRENT_DATE())  and tdd.FLD_OPERATING_CITY_ID not in (46,47) and tud.FLD_STATUS = 3 and "
            "tdd.FLD_STATUS = 3 and tud.FLD_USER_ID = 7387 ")

        user_ids = cursor.fetchall()
        print(user_ids)

        url = 'https://apiURL/notification/push'

        bearer_token = '00000000000..'

        headers = {
            'Authorization': f'Bearer {bearer_token}',
            'Content-Type': 'application/json'
        }
        sms_messages = {
            'Mumbai': "à¤ªà¥à¤°à¤¿à¤¯, à¤¤à¥à¤®à¤šà¤¾ à¤¦à¤¿à¤µà¤¸ à¤¤à¥à¤®à¤šà¥à¤¯à¤¾ à¤¡à¥à¤°à¤¾à¤ˆà¤µà¥à¤¹à¤¸à¤¾à¤°à¤–à¤¾ à¤µà¤¿à¤²à¤•à¥à¤·à¤£ à¤œà¤¾à¤µà¥‹! à¤¤à¥à¤®à¤šà¤¾ à¤¦à¤¿à¤µà¤¸ à¤†à¤¨à¤‚à¤¦à¤¾à¤šà¥à¤¯à¤¾ à¤•à¥à¤·à¤£à¤¾à¤‚à¤¸à¤¹ à¤¸à¥à¤°à¤•à¥à¤·à¤¿à¤¤ à¤†à¤£à¤¿ à¤–à¥à¤¶à¤¹à¤¾à¤² à¤ªà¥à¤°à¤µà¤¾à¤¸à¤¾à¤¨à¥‡ à¤­à¤°à¤²à¥‡à¤²à¤¾ à¤œà¤¾à¤µà¥‹!",
            'Gurgaon': "à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— à¤ªà¤°à¤¿à¤µà¤¾à¤° à¤®à¤‚à¤—à¤² à¤•à¤¾à¤®à¤¨à¤¾ à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆ à¤•à¤¿ à¤†à¤¨à¥‡ à¤µà¤¾à¤²à¤¾ à¤¸à¤¾à¤² à¤†à¤ªà¤•à¥€ à¤‰à¤¤à¥à¤¤à¤® à¤¡à¥à¤°à¤¾à¤‡à¤µà¤¿à¤‚à¤— à¤•à¥€ à¤¤à¤°à¤¹ à¤¹à¥€ à¤†à¤ªà¤•à¥‡ à¤²à¤¿à¤ à¤…à¤¤à¤¿à¤‰à¤¤à¥à¤¤à¤® à¤¸à¤¾à¤¬à¤¿à¤¤ à¤¹à¥‹.à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— à¤•à¥‡ à¤¸à¤¾à¤¥ à¤œà¥à¥œà¥‡ à¤°à¤¹à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤§à¤¨à¥à¤¯à¤µà¤¾à¤¦à¥à¥¤",
            'Delhi': "à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— à¤ªà¤°à¤¿à¤µà¤¾à¤° à¤®à¤‚à¤—à¤² à¤•à¤¾à¤®à¤¨à¤¾ à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆ à¤•à¤¿ à¤†à¤¨à¥‡ à¤µà¤¾à¤²à¤¾ à¤¸à¤¾à¤² à¤†à¤ªà¤•à¥€ à¤‰à¤¤à¥à¤¤à¤® à¤¡à¥à¤°à¤¾à¤‡à¤µà¤¿à¤‚à¤— à¤•à¥€ à¤¤à¤°à¤¹ à¤¹à¥€ à¤†à¤ªà¤•à¥‡ à¤²à¤¿à¤ à¤…à¤¤à¤¿à¤‰à¤¤à¥à¤¤à¤® à¤¸à¤¾à¤¬à¤¿à¤¤ à¤¹à¥‹.à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— à¤•à¥‡ à¤¸à¤¾à¤¥ à¤œà¥à¥œà¥‡ à¤°à¤¹à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤§à¤¨à¥à¤¯à¤µà¤¾à¤¦à¥à¥¤",
            'Noida': "à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— à¤ªà¤°à¤¿à¤µà¤¾à¤° à¤®à¤‚à¤—à¤² à¤•à¤¾à¤®à¤¨à¤¾ à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆ à¤•à¤¿ à¤†à¤¨à¥‡ à¤µà¤¾à¤²à¤¾ à¤¸à¤¾à¤² à¤†à¤ªà¤•à¥€ à¤‰à¤¤à¥à¤¤à¤® à¤¡à¥à¤°à¤¾à¤‡à¤µà¤¿à¤‚à¤— à¤•à¥€ à¤¤à¤°à¤¹ à¤¹à¥€ à¤†à¤ªà¤•à¥‡ à¤²à¤¿à¤ à¤…à¤¤à¤¿à¤‰à¤¤à¥à¤¤à¤® à¤¸à¤¾à¤¬à¤¿à¤¤ à¤¹à¥‹.à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— à¤•à¥‡ à¤¸à¤¾à¤¥ à¤œà¥à¥œà¥‡ à¤°à¤¹à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤§à¤¨à¥à¤¯à¤µà¤¾à¤¦à¥à¥¤",
            'Chandigarh': "à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— à¤ªà¤°à¤¿à¤µà¤¾à¤° à¤®à¤‚à¤—à¤² à¤•à¤¾à¤®à¤¨à¤¾ à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆ à¤•à¤¿ à¤†à¤¨à¥‡ à¤µà¤¾à¤²à¤¾ à¤¸à¤¾à¤² à¤†à¤ªà¤•à¥€ à¤‰à¤¤à¥à¤¤à¤® à¤¡à¥à¤°à¤¾à¤‡à¤µà¤¿à¤‚à¤— à¤•à¥€ à¤¤à¤°à¤¹ à¤¹à¥€ à¤†à¤ªà¤•à¥‡ à¤²à¤¿à¤ à¤…à¤¤à¤¿à¤‰à¤¤à¥à¤¤à¤® à¤¸à¤¾à¤¬à¤¿à¤¤ à¤¹à¥‹.à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— à¤•à¥‡ à¤¸à¤¾à¤¥ à¤œà¥à¥œà¥‡ à¤°à¤¹à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤§à¤¨à¥à¤¯à¤µà¤¾à¤¦à¥à¥¤",
            'Faridabad': "à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— à¤ªà¤°à¤¿à¤µà¤¾à¤° à¤®à¤‚à¤—à¤² à¤•à¤¾à¤®à¤¨à¤¾ à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆ à¤•à¤¿ à¤†à¤¨à¥‡ à¤µà¤¾à¤²à¤¾ à¤¸à¤¾à¤² à¤†à¤ªà¤•à¥€ à¤‰à¤¤à¥à¤¤à¤® à¤¡à¥à¤°à¤¾à¤‡à¤µà¤¿à¤‚à¤— à¤•à¥€ à¤¤à¤°à¤¹ à¤¹à¥€ à¤†à¤ªà¤•à¥‡ à¤²à¤¿à¤ à¤…à¤¤à¤¿à¤‰à¤¤à¥à¤¤à¤® à¤¸à¤¾à¤¬à¤¿à¤¤ à¤¹à¥‹.à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— à¤•à¥‡ à¤¸à¤¾à¤¥ à¤œà¥à¥œà¥‡ à¤°à¤¹à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤§à¤¨à¥à¤¯à¤µà¤¾à¤¦à¥à¥¤",
            'Lucknow': "à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— à¤ªà¤°à¤¿à¤µà¤¾à¤° à¤®à¤‚à¤—à¤² à¤•à¤¾à¤®à¤¨à¤¾ à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆ à¤•à¤¿ à¤†à¤¨à¥‡ à¤µà¤¾à¤²à¤¾ à¤¸à¤¾à¤² à¤†à¤ªà¤•à¥€ à¤‰à¤¤à¥à¤¤à¤® à¤¡à¥à¤°à¤¾à¤‡à¤µà¤¿à¤‚à¤— à¤•à¥€ à¤¤à¤°à¤¹ à¤¹à¥€ à¤†à¤ªà¤•à¥‡ à¤²à¤¿à¤ à¤…à¤¤à¤¿à¤‰à¤¤à¥à¤¤à¤® à¤¸à¤¾à¤¬à¤¿à¤¤ à¤¹à¥‹.à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— à¤•à¥‡ à¤¸à¤¾à¤¥ à¤œà¥à¥œà¥‡ à¤°à¤¹à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤§à¤¨à¥à¤¯à¤µà¤¾à¤¦à¥à¥¤",
            'Jaipur': "à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— à¤ªà¤°à¤¿à¤µà¤¾à¤° à¤®à¤‚à¤—à¤² à¤•à¤¾à¤®à¤¨à¤¾ à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆ à¤•à¤¿ à¤†à¤¨à¥‡ à¤µà¤¾à¤²à¤¾ à¤¸à¤¾à¤² à¤†à¤ªà¤•à¥€ à¤‰à¤¤à¥à¤¤à¤® à¤¡à¥à¤°à¤¾à¤‡à¤µà¤¿à¤‚à¤— à¤•à¥€ à¤¤à¤°à¤¹ à¤¹à¥€ à¤†à¤ªà¤•à¥‡ à¤²à¤¿à¤ à¤…à¤¤à¤¿à¤‰à¤¤à¥à¤¤à¤® à¤¸à¤¾à¤¬à¤¿à¤¤ à¤¹à¥‹.à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— à¤•à¥‡ à¤¸à¤¾à¤¥ à¤œà¥à¥œà¥‡ à¤°à¤¹à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤§à¤¨à¥à¤¯à¤µà¤¾à¤¦à¥à¥¤",
            'Ludhiana': "à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— à¤ªà¤°à¤¿à¤µà¤¾à¤° à¤®à¤‚à¤—à¤² à¤•à¤¾à¤®à¤¨à¤¾ à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆ à¤•à¤¿ à¤†à¤¨à¥‡ à¤µà¤¾à¤²à¤¾ à¤¸à¤¾à¤² à¤†à¤ªà¤•à¥€ à¤‰à¤¤à¥à¤¤à¤® à¤¡à¥à¤°à¤¾à¤‡à¤µà¤¿à¤‚à¤— à¤•à¥€ à¤¤à¤°à¤¹ à¤¹à¥€ à¤†à¤ªà¤•à¥‡ à¤²à¤¿à¤ à¤…à¤¤à¤¿à¤‰à¤¤à¥à¤¤à¤® à¤¸à¤¾à¤¬à¤¿à¤¤ à¤¹à¥‹.à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— à¤•à¥‡ à¤¸à¤¾à¤¥ à¤œà¥à¥œà¥‡ à¤°à¤¹à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤§à¤¨à¥à¤¯à¤µà¤¾à¤¦à¥à¥¤",
            'Patna': "à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— à¤ªà¤°à¤¿à¤µà¤¾à¤° à¤®à¤‚à¤—à¤² à¤•à¤¾à¤®à¤¨à¤¾ à¤•à¤°à¤¤à¤¾ à¤¹à¥ˆ à¤•à¤¿ à¤†à¤¨à¥‡ à¤µà¤¾à¤²à¤¾ à¤¸à¤¾à¤² à¤†à¤ªà¤•à¥€ à¤‰à¤¤à¥à¤¤à¤® à¤¡à¥à¤°à¤¾à¤‡à¤µà¤¿à¤‚à¤— à¤•à¥€ à¤¤à¤°à¤¹ à¤¹à¥€ à¤†à¤ªà¤•à¥‡ à¤²à¤¿à¤ à¤…à¤¤à¤¿à¤‰à¤¤à¥à¤¤à¤® à¤¸à¤¾à¤¬à¤¿à¤¤ à¤¹à¥‹.à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— à¤•à¥‡ à¤¸à¤¾à¤¥ à¤œà¥à¥œà¥‡ à¤°à¤¹à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤§à¤¨à¥à¤¯à¤µà¤¾à¤¦à¥à¥¤",
            'Pune': "à¤ªà¥à¤°à¤¿à¤¯, à¤¤à¥à¤®à¤šà¤¾ à¤¦à¤¿à¤µà¤¸ à¤¤à¥à¤®à¤šà¥à¤¯à¤¾ à¤¡à¥à¤°à¤¾à¤ˆà¤µà¥à¤¹à¤¸à¤¾à¤°à¤–à¤¾ à¤µà¤¿à¤²à¤•à¥à¤·à¤£ à¤œà¤¾à¤µà¥‹! à¤¤à¥à¤®à¤šà¤¾ à¤¦à¤¿à¤µà¤¸ à¤†à¤¨à¤‚à¤¦à¤¾à¤šà¥à¤¯à¤¾ à¤•à¥à¤·à¤£à¤¾à¤‚à¤¸à¤¹ à¤¸à¥à¤°à¤•à¥à¤·à¤¿à¤¤ à¤†à¤£à¤¿ à¤–à¥à¤¶à¤¹à¤¾à¤² à¤ªà¥à¤°à¤µà¤¾à¤¸à¤¾à¤¨à¥‡ à¤­à¤°à¤²à¥‡à¤²à¤¾ à¤œà¤¾à¤µà¥‹!",
            'Bengaluru': "à²†à²¤à³à²®à³€à²¯ , à²¨à²¿à²®à³à²® à²¡à³à²°à³ˆà²µà³ à²—à²³à²‚à²¤à³† à²¨à²¿à²®à³à²® à²¦à²¿à²¨ à²•à³‚à²¡à²¾ à²…à²¦à³à²­à³à²¤à²µà²¾à²—à²¿à²°à²²à²¿ à²Žà²‚à²¦à³ à²¹à²¾à²°à³ˆà²¸à³à²¤à³à²¤à³‡à²µà³†! à²¨à²¿à²®à³à²® à²¦à²¿à²¨à²µà³ à²¸à²‚à²¤à³‹à²·à²¦à²¾à²¯à²• à²•à³à²·à²£à²—à²³à³Šà²‚à²¦à²¿à²—à³† à²¸à³à²°à²•à³à²·à²¿à²¤ à²¹à²¾à²—à³‚ à²¸à²°à²¾à²—à²µà²¾à²¦ à²ªà³à²°à²¯à²¾à²£à²—à²³à²¿à²‚à²¦ à²¤à³à²‚à²¬à²¿à²°à²²à²¿ !ðŸŽ‚ðŸŽŠðŸŽ‰",
            'Chennai': "à®…à®©à¯à®ªà¯à®Ÿà¯ˆà®¯à¯€à®°à¯,  à®‰à®™à¯à®•à®³à¯ à®…à®°à¯à®®à¯ˆà®¯à®¾à®© à®’à®Ÿà¯à®Ÿà¯à®¤à®²à¯ˆà®ªà¯à®ªà¯‹à®² à®‰à®™à¯à®•à®³à®¤à¯ à®¨à®¾à®³à¯à®®à¯ à®‡à®©à®¿à®¤à¯‡ à®…à®®à¯ˆà®¯à®Ÿà¯à®Ÿà¯à®®à¯! à®‰à®™à¯à®•à®³à¯ à®¨à®¾à®³à¯ à®®à®•à®¿à®´à¯à®šà¯à®šà®¿à®¯à®¾à®© à®¤à®°à¯à®£à®™à¯à®•à®³à¯à®Ÿà®©à¯ à®ªà®¾à®¤à¯à®•à®¾à®ªà¯à®ªà®¾à®© à®®à®±à¯à®±à¯à®®à¯ à®®à¯†à®©à¯à®®à¯ˆà®¯à®¾à®© à®šà®µà®¾à®°à®¿à®•à®³à®¾à®²à¯ à®¨à®¿à®°à®ªà¯à®ªà®ªà¯à®ªà®Ÿà®Ÿà¯à®Ÿà¯à®®à¯!ðŸŽ‚ðŸŽŠðŸŽ‰",
            'Hyderabad': "à°ªà±à°°à°¿à°¯à°®à±ˆà°¨, à°®à±€ à°¡à±à°°à±ˆà°µà±â€Œà°² à°²à°¾à°—à°¾à°¨à±‡ à°®à±€à°•à± à°’à°• à°…à°¦à±à°­à±à°¤à°®à±ˆà°¨ à°°à±‹à°œà±à°—à°¾ à°‰à°‚à°¡à°¾à°²à°¨à°¿ à°®à±‡à°®à± à°•à±‹à°°à±à°•à±à°‚à°Ÿà±à°¨à±à°¨à°¾à°®à±! à°®à±€ à°°à±‹à°œà± à°¸à°‚à°¤à±‹à°·à°•à°°à°®à±ˆà°¨ à°•à±à°·à°£à°¾à°²à°¤à±‹ à°¸à±à°°à°•à±à°·à°¿à°¤à°®à±ˆà°¨ à°®à°°à°¿à°¯à± à°¸à±à°²à°­à°®à±ˆà°¨ à°°à±ˆà°¡à±â€Œà°²à°¤à±‹ à°¨à°¿à°‚à°¡à°¿à°ªà±‹à°¨à°¿à°µà±à°µà°‚à°¡à°¿!ðŸŽ‚ðŸŽŠðŸŽ‰",
            'Kolkata': "à¦ªà§à¦°à¦¿à§Ÿ , à¦†à¦ªà¦¨à¦¾à¦° à¦¡à§à¦°à¦¾à¦‡à¦­à§‡à¦° à¦®à¦¤à¦‡ à¦†à¦ªà¦¨à¦¾à¦° à¦¦à¦¿à¦¨ à¦¯à§‡à¦¨ à¦…à¦¸à¦¾à¦§à¦¾à¦°à¦£ à¦•à¦¾à¦Ÿà§‡! à¦†à¦¶à¦¾ à¦•à¦°à¦¿ à¦†à¦ªà¦¨à¦¾à¦° à¦¦à¦¿à¦¨à¦Ÿà¦¿ à¦¯à§‡à¦¨ à¦†à¦¨à¦¨à§à¦¦à¦®à¦¯à¦¼ à¦®à§à¦¹à§‚à¦°à§à¦¤à¦—à§à¦²à¦¿à¦° à¦¸à¦¾à¦¥à§‡ à¦¨à¦¿à¦°à¦¾à¦ªà¦¦ à¦à¦¬à¦‚ à¦®à¦¸à§ƒà¦£ à¦°à¦¾à¦‡à¦¡ à¦¦à¦¿à§Ÿà§‡ à¦¸à¦®à§à¦ªà§‚à¦°à§à¦£ à¦¹à§Ÿ!ðŸŽ‚ðŸŽŠðŸŽ‰",
        }

        sms_headers = {
            'Mumbai': "MoEVing à¤•à¤¡à¥‚à¤¨ à¤µà¤¾à¤¢à¤¦à¤¿à¤µà¤¸à¤¾à¤šà¥à¤¯à¤¾ à¤¶à¥à¤­à¥‡à¤šà¥à¤›à¤¾!",
            'Gurgaon': "à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— (MoEVing ) à¤•à¥€ à¤¤à¤°à¤« à¤†à¤ªà¤•à¥‹ à¤œà¤¨à¥à¤®à¤¦à¤¿à¤¨ à¤•à¥€ à¤¹à¤¾à¤°à¥à¤¦à¤¿à¤• à¤¶à¥à¤­à¤•à¤¾à¤®à¤¨à¤¾à¤¯à¥‡",
            'Delhi': "à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— (MoEVing ) à¤•à¥€ à¤¤à¤°à¤« à¤†à¤ªà¤•à¥‹ à¤œà¤¨à¥à¤®à¤¦à¤¿à¤¨ à¤•à¥€ à¤¹à¤¾à¤°à¥à¤¦à¤¿à¤• à¤¶à¥à¤­à¤•à¤¾à¤®à¤¨à¤¾à¤¯à¥‡",
            'Noida': "à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— (MoEVing ) à¤•à¥€ à¤¤à¤°à¤« à¤†à¤ªà¤•à¥‹ à¤œà¤¨à¥à¤®à¤¦à¤¿à¤¨ à¤•à¥€ à¤¹à¤¾à¤°à¥à¤¦à¤¿à¤• à¤¶à¥à¤­à¤•à¤¾à¤®à¤¨à¤¾à¤¯à¥‡",
            'Chandigarh': "à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— (MoEVing ) à¤•à¥€ à¤¤à¤°à¤« à¤†à¤ªà¤•à¥‹ à¤œà¤¨à¥à¤®à¤¦à¤¿à¤¨ à¤•à¥€ à¤¹à¤¾à¤°à¥à¤¦à¤¿à¤• à¤¶à¥à¤­à¤•à¤¾à¤®à¤¨à¤¾à¤¯à¥‡",
            'Faridabad': "à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— (MoEVing ) à¤•à¥€ à¤¤à¤°à¤« à¤†à¤ªà¤•à¥‹ à¤œà¤¨à¥à¤®à¤¦à¤¿à¤¨ à¤•à¥€ à¤¹à¤¾à¤°à¥à¤¦à¤¿à¤• à¤¶à¥à¤­à¤•à¤¾à¤®à¤¨à¤¾à¤¯à¥‡",
            'Lucknow': "à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— (MoEVing ) à¤•à¥€ à¤¤à¤°à¤« à¤†à¤ªà¤•à¥‹ à¤œà¤¨à¥à¤®à¤¦à¤¿à¤¨ à¤•à¥€ à¤¹à¤¾à¤°à¥à¤¦à¤¿à¤• à¤¶à¥à¤­à¤•à¤¾à¤®à¤¨à¤¾à¤¯à¥‡",
            'Jaipur': "à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— (MoEVing ) à¤•à¥€ à¤¤à¤°à¤« à¤†à¤ªà¤•à¥‹ à¤œà¤¨à¥à¤®à¤¦à¤¿à¤¨ à¤•à¥€ à¤¹à¤¾à¤°à¥à¤¦à¤¿à¤• à¤¶à¥à¤­à¤•à¤¾à¤®à¤¨à¤¾à¤¯à¥‡",
            'Ludhiana': "à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— (MoEVing ) à¤•à¥€ à¤¤à¤°à¤« à¤†à¤ªà¤•à¥‹ à¤œà¤¨à¥à¤®à¤¦à¤¿à¤¨ à¤•à¥€ à¤¹à¤¾à¤°à¥à¤¦à¤¿à¤• à¤¶à¥à¤­à¤•à¤¾à¤®à¤¨à¤¾à¤¯à¥‡",
            'Patna': "à¤®à¥‹à¤‡à¤µà¤¿à¤‚à¤— (MoEVing ) à¤•à¥€ à¤¤à¤°à¤« à¤†à¤ªà¤•à¥‹ à¤œà¤¨à¥à¤®à¤¦à¤¿à¤¨ à¤•à¥€ à¤¹à¤¾à¤°à¥à¤¦à¤¿à¤• à¤¶à¥à¤­à¤•à¤¾à¤®à¤¨à¤¾à¤¯à¥‡",
            'Pune': "MoEVing à¤•à¤¡à¥‚à¤¨ à¤µà¤¾à¤¢à¤¦à¤¿à¤µà¤¸à¤¾à¤šà¥à¤¯à¤¾ à¤¶à¥à¤­à¥‡à¤šà¥à¤›à¤¾!",
            'Bengaluru': "MoEVing à²•à²¡à³†à²¯à²¿à²‚à²¦ à²¹à³à²Ÿà³à²Ÿà²¿à²¦à²¹à²¬à³à²¬à²¦ à²¶à³à²­à²¾à²¶à²¯à²—à²³à³ !",
            'Chennai': "MoEVing à®‡à®Ÿà®®à®¿à®°à¯à®¨à¯à®¤à¯ à®ªà®¿à®±à®¨à¯à®¤à®¨à®¾à®³à¯ à®µà®¾à®´à¯à®¤à¯à®¤à¯à®•à¯à®•à®³à¯ !",
            'Hyderabad': "MoEVing à°¨à±à°‚à°¡à°¿ à°ªà±à°Ÿà±à°Ÿà°¿à°¨à°°à±‹à°œà± à°¶à±à°­à°¾à°•à°¾à°‚à°•à±à°·à°²à± !",
            'Kolkata': "MoEVing (à¦®à§à¦­à¦¿à¦‚)-à¦à¦° à¦¤à¦°à¦« à¦¥à§‡à¦•à§‡ à¦œà¦¨à§à¦®à¦¦à¦¿à¦¨à§‡à¦° à¦†à¦¨à§à¦¤à¦°à¦¿à¦• à¦¶à§à¦­à§‡à¦šà§à¦›à¦¾ !",
        }

        sms_language = {
            'Mumbai': "Marathi",
            'Gurgaon': "Hindi",
            'Delhi': "Hindi",
            'Noida': "Hindi",
            'Chandigarh': "Hindi",
            'Faridabad': "Hindi",
            'Lucknow': "Hindi",
            'Jaipur': "Hindi",
            'Ludhiana': "Hindi",
            'Patna': "Hindi",
            'Pune': "Marathi",
            'Bengaluru': "Kannada",
            'Chennai': "Tamil",
            'Hyderabad': "Telugu",
            'Kolkata': "Bengali",
        }

        city_sms_count = {}

        for user_id in user_ids:
            city_name = user_id[3]
            contact = user_id[1]
            user_id = user_id[0]

            if str(city_name) in sms_messages and str(city_name) in sms_headers:
                params = {
                    "notification_type": "whatsapp",
                    "user_id": user_id,
                    "mobile_number": contact,
                    "message": sms_messages[str(city_name)],
                    "title": sms_headers[str(city_name)],
                    "notification_source": "scheduler-service"
                }

                # Convert payload to JSON string
                json_payload = json.dumps(params)

                response = requests.post(url, headers=headers, data=json_payload)

                # Increment city-wise SMS count
                city_sms_count[city_name] = city_sms_count.get(city_name, 0) + 1 if response.status_code == 200 else 0

                if response.status_code == 200:
                    print(f"User ID: {user_id} - Response: {response.json()}")
                else:
                    print(f"User ID: {user_id} - Request failed with status code: {response.status_code}")

                time.sleep(1)

        # Print-city-wise SMS counts outside the loop
        for city_name, count in city_sms_count.items():
            # print(f"City: {city_name}, SMS Count: {count}")
            if count >= 1:
                bot_message = {
                    'text': f"Birthday wish message by Whatsapp Bot from MoEVing sent to {count} {city_name} Driver(s) in {sms_language[city_name]}."}

                print(bot_message['text'].replace('```', ''))

                message_headers = {'Content-Type': 'application/json; charset=UTF-8'}
                # Prod
                # url = 'https://chat.googleapis.com/v1/spaces/AAAAl5asBn0/messages?key=-&token=-mTOhNSD4BO2DoH-'

                # Test
                url = 'https://chat.googleapis.com/v1/spaces/AAAAQqFHSzs/messages?key=-&=%3D'
                http_obj = Http()
                response = http_obj.request(
                    uri=url,
                    method='POST',
                    headers=message_headers,
                    body=dumps(bot_message),
                )

                conn.close()

