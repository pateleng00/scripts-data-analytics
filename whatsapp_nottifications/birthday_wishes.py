from json import dumps
import requests
import time
from httplib2 import Http
from mysql.connector import MySQLConnection

from python_mysql_dbconfig import read_db_config


class BirthdayWhatsApp:
    def get_drivers_detail(self):
        dbconfig = read_db_config()
        conn = MySQLConnection(**dbconfig)
        cursor = conn.cursor()
        cursor.execute(
            "SELECT tud.FLD_USER_ID, tud.FLD_LOGIN_NAME, tld.FLD_LOCATION_ID, tld.FLD_LOCATION_NAME FROM "
            "TBL_PROFILE_DETAILS tpd INNER JOIN TBL_USER_DETAILS tud ON tud.FLD_USER_ID = tpd.FLD_USER_ID "
            "inner join TBL_LOCATION_DETAILS tld on tld.FLD_LOCATION_ID  = tud.FLD_OPERATING_CITY_ID "
            "inner join TBL_DRIVER_DETAILS tdd on tdd.FLD_DRIVER_USER_ID = tud.FLD_USER_ID  WHERE month("
            "tpd.FLD_DATE_OF_BIRTH) = month(CURRENT_DATE()) and  DAY(tpd.FLD_DATE_OF_BIRTH) = DAY( "
            "CURRENT_DATE())  and tdd.FLD_OPERATING_CITY_ID not in (46,47) and tud.FLD_STATUS = 3 and "
            "tdd.FLD_STATUS = 3 and tud.FLD_USER_ID = 7387 ")

        user_ids = cursor.fetchall()
        print(user_ids)

        url = 'https://media.smsgupshup.com/GatewayAPI/rest'
        headers = {
            'Content-Type': 'application/x-www-form-urlencoded'
        }

        sms_messages = {
            'Mumbai': "рдореЛрдЗрд╡рд┐рдВрдЧ рдкрд░рд┐рд╡рд╛рд░ рдордВрдЧрд▓ рдХрд╛рдордирд╛ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЖрдиреЗ рд╡рд╛рд▓рд╛ рд╕рд╛рд▓ рдЖрдкрдХреА рдЙрддреНрддрдо рдбреНрд░рд╛рдЗрд╡рд┐рдВрдЧ рдХреА рддрд░рд╣ рд╣реА рдЖрдкрдХреЗ рд▓рд┐рдП рдЕрддрд┐рдЙрддреНрддрдо рд╕рд╛рдмрд┐рдд рд╣реЛ.рдореЛрдЗрд╡рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдЬреБреЬреЗ рд░рд╣рдиреЗ рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рджреНред",
            'Gurgaon': "рдореЛрдЗрд╡рд┐рдВрдЧ рдкрд░рд┐рд╡рд╛рд░ рдордВрдЧрд▓ рдХрд╛рдордирд╛ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЖрдиреЗ рд╡рд╛рд▓рд╛ рд╕рд╛рд▓ рдЖрдкрдХреА рдЙрддреНрддрдо рдбреНрд░рд╛рдЗрд╡рд┐рдВрдЧ рдХреА рддрд░рд╣ рд╣реА рдЖрдкрдХреЗ рд▓рд┐рдП рдЕрддрд┐рдЙрддреНрддрдо рд╕рд╛рдмрд┐рдд рд╣реЛ.рдореЛрдЗрд╡рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдЬреБреЬреЗ рд░рд╣рдиреЗ рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рджреНред",
            'Delhi': "рдореЛрдЗрд╡рд┐рдВрдЧ рдкрд░рд┐рд╡рд╛рд░ рдордВрдЧрд▓ рдХрд╛рдордирд╛ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЖрдиреЗ рд╡рд╛рд▓рд╛ рд╕рд╛рд▓ рдЖрдкрдХреА рдЙрддреНрддрдо рдбреНрд░рд╛рдЗрд╡рд┐рдВрдЧ рдХреА рддрд░рд╣ рд╣реА рдЖрдкрдХреЗ рд▓рд┐рдП рдЕрддрд┐рдЙрддреНрддрдо рд╕рд╛рдмрд┐рдд рд╣реЛ.рдореЛрдЗрд╡рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдЬреБреЬреЗ рд░рд╣рдиреЗ рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рджреНред",
            'Noida': "рдореЛрдЗрд╡рд┐рдВрдЧ рдкрд░рд┐рд╡рд╛рд░ рдордВрдЧрд▓ рдХрд╛рдордирд╛ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЖрдиреЗ рд╡рд╛рд▓рд╛ рд╕рд╛рд▓ рдЖрдкрдХреА рдЙрддреНрддрдо рдбреНрд░рд╛рдЗрд╡рд┐рдВрдЧ рдХреА рддрд░рд╣ рд╣реА рдЖрдкрдХреЗ рд▓рд┐рдП рдЕрддрд┐рдЙрддреНрддрдо рд╕рд╛рдмрд┐рдд рд╣реЛ.рдореЛрдЗрд╡рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдЬреБреЬреЗ рд░рд╣рдиреЗ рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рджреНред",
            'Chandigarh': "рдореЛрдЗрд╡рд┐рдВрдЧ рдкрд░рд┐рд╡рд╛рд░ рдордВрдЧрд▓ рдХрд╛рдордирд╛ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЖрдиреЗ рд╡рд╛рд▓рд╛ рд╕рд╛рд▓ рдЖрдкрдХреА рдЙрддреНрддрдо рдбреНрд░рд╛рдЗрд╡рд┐рдВрдЧ рдХреА рддрд░рд╣ рд╣реА рдЖрдкрдХреЗ рд▓рд┐рдП рдЕрддрд┐рдЙрддреНрддрдо рд╕рд╛рдмрд┐рдд рд╣реЛ.рдореЛрдЗрд╡рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдЬреБреЬреЗ рд░рд╣рдиреЗ рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рджреНред",
            'Faridabad': "рдореЛрдЗрд╡рд┐рдВрдЧ рдкрд░рд┐рд╡рд╛рд░ рдордВрдЧрд▓ рдХрд╛рдордирд╛ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЖрдиреЗ рд╡рд╛рд▓рд╛ рд╕рд╛рд▓ рдЖрдкрдХреА рдЙрддреНрддрдо рдбреНрд░рд╛рдЗрд╡рд┐рдВрдЧ рдХреА рддрд░рд╣ рд╣реА рдЖрдкрдХреЗ рд▓рд┐рдП рдЕрддрд┐рдЙрддреНрддрдо рд╕рд╛рдмрд┐рдд рд╣реЛ.рдореЛрдЗрд╡рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдЬреБреЬреЗ рд░рд╣рдиреЗ рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рджреНред",
            'Lucknow': "рдореЛрдЗрд╡рд┐рдВрдЧ рдкрд░рд┐рд╡рд╛рд░ рдордВрдЧрд▓ рдХрд╛рдордирд╛ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЖрдиреЗ рд╡рд╛рд▓рд╛ рд╕рд╛рд▓ рдЖрдкрдХреА рдЙрддреНрддрдо рдбреНрд░рд╛рдЗрд╡рд┐рдВрдЧ рдХреА рддрд░рд╣ рд╣реА рдЖрдкрдХреЗ рд▓рд┐рдП рдЕрддрд┐рдЙрддреНрддрдо рд╕рд╛рдмрд┐рдд рд╣реЛ.рдореЛрдЗрд╡рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдЬреБреЬреЗ рд░рд╣рдиреЗ рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рджреНред",
            'Jaipur': "рдореЛрдЗрд╡рд┐рдВрдЧ рдкрд░рд┐рд╡рд╛рд░ рдордВрдЧрд▓ рдХрд╛рдордирд╛ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЖрдиреЗ рд╡рд╛рд▓рд╛ рд╕рд╛рд▓ рдЖрдкрдХреА рдЙрддреНрддрдо рдбреНрд░рд╛рдЗрд╡рд┐рдВрдЧ рдХреА рддрд░рд╣ рд╣реА рдЖрдкрдХреЗ рд▓рд┐рдП рдЕрддрд┐рдЙрддреНрддрдо рд╕рд╛рдмрд┐рдд рд╣реЛ.рдореЛрдЗрд╡рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдЬреБреЬреЗ рд░рд╣рдиреЗ рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рджреНред",
            'Ludhiana': "рдореЛрдЗрд╡рд┐рдВрдЧ рдкрд░рд┐рд╡рд╛рд░ рдордВрдЧрд▓ рдХрд╛рдордирд╛ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЖрдиреЗ рд╡рд╛рд▓рд╛ рд╕рд╛рд▓ рдЖрдкрдХреА рдЙрддреНрддрдо рдбреНрд░рд╛рдЗрд╡рд┐рдВрдЧ рдХреА рддрд░рд╣ рд╣реА рдЖрдкрдХреЗ рд▓рд┐рдП рдЕрддрд┐рдЙрддреНрддрдо рд╕рд╛рдмрд┐рдд рд╣реЛ.рдореЛрдЗрд╡рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдЬреБреЬреЗ рд░рд╣рдиреЗ рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рджреНред",
            'Patna': "рдореЛрдЗрд╡рд┐рдВрдЧ рдкрд░рд┐рд╡рд╛рд░ рдордВрдЧрд▓ рдХрд╛рдордирд╛ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЖрдиреЗ рд╡рд╛рд▓рд╛ рд╕рд╛рд▓ рдЖрдкрдХреА рдЙрддреНрддрдо рдбреНрд░рд╛рдЗрд╡рд┐рдВрдЧ рдХреА рддрд░рд╣ рд╣реА рдЖрдкрдХреЗ рд▓рд┐рдП рдЕрддрд┐рдЙрддреНрддрдо рд╕рд╛рдмрд┐рдд рд╣реЛ.рдореЛрдЗрд╡рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдЬреБреЬреЗ рд░рд╣рдиреЗ рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рджреНред",
            'Pune': "рдореЛрдЗрд╡рд┐рдВрдЧ рдкрд░рд┐рд╡рд╛рд░ рдордВрдЧрд▓ рдХрд╛рдордирд╛ рдХрд░рддрд╛ рд╣реИ рдХрд┐ рдЖрдиреЗ рд╡рд╛рд▓рд╛ рд╕рд╛рд▓ рдЖрдкрдХреА рдЙрддреНрддрдо рдбреНрд░рд╛рдЗрд╡рд┐рдВрдЧ рдХреА рддрд░рд╣ рд╣реА рдЖрдкрдХреЗ рд▓рд┐рдП рдЕрддрд┐рдЙрддреНрддрдо рд╕рд╛рдмрд┐рдд рд╣реЛ.рдореЛрдЗрд╡рд┐рдВрдЧ рдХреЗ рд╕рд╛рде рдЬреБреЬреЗ рд░рд╣рдиреЗ рдХреЗ рд▓рд┐рдП рдзрдиреНрдпрд╡рд╛рджреНред",
            'Bengaluru': "р▓Жр▓др│Нр▓ор│Ар▓п , р▓ир▓┐р▓ор│Нр▓о р▓бр│Нр▓░р│Ир▓╡р│Н р▓Чр▓│р▓Вр▓др│Ж р▓ир▓┐р▓ор│Нр▓о р▓жр▓┐р▓и р▓Хр│Вр▓бр▓╛ р▓Ер▓жр│Нр▓нр│Бр▓др▓╡р▓╛р▓Чр▓┐р▓░р▓▓р▓┐ р▓Ор▓Вр▓жр│Б р▓╣р▓╛р▓░р│Ир▓╕р│Бр▓др│Нр▓др│Зр▓╡р│Ж! р▓ир▓┐р▓ор│Нр▓о р▓жр▓┐р▓ир▓╡р│Б р▓╕р▓Вр▓др│Лр▓╖р▓жр▓╛р▓пр▓Х р▓Хр│Нр▓╖р▓гр▓Чр▓│р│Кр▓Вр▓жр▓┐р▓Чр│Ж р▓╕р│Бр▓░р▓Хр│Нр▓╖р▓┐р▓д р▓╣р▓╛р▓Чр│В р▓╕р▓░р▓╛р▓Чр▓╡р▓╛р▓ж р▓кр│Нр▓░р▓пр▓╛р▓гр▓Чр▓│р▓┐р▓Вр▓ж р▓др│Бр▓Вр▓мр▓┐р▓░р▓▓р▓┐ !ЁЯОВЁЯОКЁЯОЙ",
            'Chennai': "роЕройрпНрокрпБроЯрпИропрпАро░рпН,  роЙроЩрпНроХро│рпН роЕро░рпБроорпИропро╛рой роТроЯрпНроЯрпБродро▓рпИрокрпНрокрпЛро▓ роЙроЩрпНроХро│родрпБ роиро╛ро│рпБроорпН роЗройро┐родрпЗ роЕроорпИропроЯрпНроЯрпБроорпН! роЙроЩрпНроХро│рпН роиро╛ро│рпН роороХро┐ро┤рпНроЪрпНроЪро┐ропро╛рой родро░рпБрогроЩрпНроХро│рпБроЯройрпН рокро╛родрпБроХро╛рокрпНрокро╛рой рооро▒рпНро▒рпБроорпН роорпЖройрпНроорпИропро╛рой роЪро╡ро╛ро░ро┐роХро│ро╛ро▓рпН роиро┐ро░рокрпНрокрокрпНрокроЯроЯрпНроЯрпБроорпН!ЁЯОВЁЯОКЁЯОЙ",
            'Hyderabad': "р░кр▒Нр░░р░┐р░пр░ор▒Ир░и, р░ор▒А р░бр▒Нр░░р▒Ир░╡р▒НтАМр░▓ р░▓р░╛р░Чр░╛р░ир▒З р░ор▒Ар░Хр▒Б р░Тр░Х р░Ер░жр▒Нр░нр▒Бр░др░ор▒Ир░и р░░р▒Лр░Ьр▒Бр░Чр░╛ р░Йр░Вр░бр░╛р░▓р░ир░┐ р░ор▒Зр░ор▒Б р░Хр▒Лр░░р▒Бр░Хр▒Бр░Вр░Яр▒Бр░ир▒Нр░ир░╛р░ор▒Б! р░ор▒А р░░р▒Лр░Ьр▒Б р░╕р░Вр░др▒Лр░╖р░Хр░░р░ор▒Ир░и р░Хр▒Нр░╖р░гр░╛р░▓р░др▒Л р░╕р▒Бр░░р░Хр▒Нр░╖р░┐р░др░ор▒Ир░и р░ор░░р░┐р░пр▒Б р░╕р▒Бр░▓р░нр░ор▒Ир░и р░░р▒Ир░бр▒НтАМр░▓р░др▒Л р░ир░┐р░Вр░бр░┐р░кр▒Лр░ир░┐р░╡р▒Нр░╡р░Вр░бр░┐!ЁЯОВЁЯОКЁЯОЙ",
            'Kolkata': "ржкрзНрж░рж┐рзЯ , ржЖржкржирж╛рж░ ржбрзНрж░рж╛ржЗржнрзЗрж░ ржорждржЗ ржЖржкржирж╛рж░ ржжрж┐ржи ржпрзЗржи ржЕрж╕рж╛ржзрж╛рж░ржг ржХрж╛ржЯрзЗ! ржЖрж╢рж╛ ржХрж░рж┐ ржЖржкржирж╛рж░ ржжрж┐ржиржЯрж┐ ржпрзЗржи ржЖржиржирзНржжржоржпрж╝ ржорзБрж╣рзВрж░рзНрждржЧрзБрж▓рж┐рж░ рж╕рж╛ржерзЗ ржирж┐рж░рж╛ржкржж ржПржмржВ ржорж╕рзГржг рж░рж╛ржЗржб ржжрж┐рзЯрзЗ рж╕ржорзНржкрзВрж░рзНржг рж╣рзЯ!ЁЯОВЁЯОКЁЯОЙ",
        }

        sms_headers = {
            'Mumbai': "рдореЛрдЗрд╡рд┐рдВрдЧ (MoEVing ) рдХреА рддрд░рдл рдЖрдкрдХреЛ рдЬрдиреНрдорджрд┐рди рдХреА рд╣рд╛рд░реНрджрд┐рдХ рд╢реБрднрдХрд╛рдордирд╛рдпреЗ",
            'Gurgaon': "рдореЛрдЗрд╡рд┐рдВрдЧ (MoEVing ) рдХреА рддрд░рдл рдЖрдкрдХреЛ рдЬрдиреНрдорджрд┐рди рдХреА рд╣рд╛рд░реНрджрд┐рдХ рд╢реБрднрдХрд╛рдордирд╛рдпреЗ",
            'Delhi': "рдореЛрдЗрд╡рд┐рдВрдЧ (MoEVing ) рдХреА рддрд░рдл рдЖрдкрдХреЛ рдЬрдиреНрдорджрд┐рди рдХреА рд╣рд╛рд░реНрджрд┐рдХ рд╢реБрднрдХрд╛рдордирд╛рдпреЗ",
            'Noida': "рдореЛрдЗрд╡рд┐рдВрдЧ (MoEVing ) рдХреА рддрд░рдл рдЖрдкрдХреЛ рдЬрдиреНрдорджрд┐рди рдХреА рд╣рд╛рд░реНрджрд┐рдХ рд╢реБрднрдХрд╛рдордирд╛рдпреЗ",
            'Chandigarh': "рдореЛрдЗрд╡рд┐рдВрдЧ (MoEVing ) рдХреА рддрд░рдл рдЖрдкрдХреЛ рдЬрдиреНрдорджрд┐рди рдХреА рд╣рд╛рд░реНрджрд┐рдХ рд╢реБрднрдХрд╛рдордирд╛рдпреЗ",
            'Faridabad': "рдореЛрдЗрд╡рд┐рдВрдЧ (MoEVing ) рдХреА рддрд░рдл рдЖрдкрдХреЛ рдЬрдиреНрдорджрд┐рди рдХреА рд╣рд╛рд░реНрджрд┐рдХ рд╢реБрднрдХрд╛рдордирд╛рдпреЗ",
            'Lucknow': "рдореЛрдЗрд╡рд┐рдВрдЧ (MoEVing ) рдХреА рддрд░рдл рдЖрдкрдХреЛ рдЬрдиреНрдорджрд┐рди рдХреА рд╣рд╛рд░реНрджрд┐рдХ рд╢реБрднрдХрд╛рдордирд╛рдпреЗ",
            'Jaipur': "рдореЛрдЗрд╡рд┐рдВрдЧ (MoEVing ) рдХреА рддрд░рдл рдЖрдкрдХреЛ рдЬрдиреНрдорджрд┐рди рдХреА рд╣рд╛рд░реНрджрд┐рдХ рд╢реБрднрдХрд╛рдордирд╛рдпреЗ",
            'Ludhiana': "рдореЛрдЗрд╡рд┐рдВрдЧ (MoEVing ) рдХреА рддрд░рдл рдЖрдкрдХреЛ рдЬрдиреНрдорджрд┐рди рдХреА рд╣рд╛рд░реНрджрд┐рдХ рд╢реБрднрдХрд╛рдордирд╛рдпреЗ",
            'Patna': "рдореЛрдЗрд╡рд┐рдВрдЧ (MoEVing ) рдХреА рддрд░рдл рдЖрдкрдХреЛ рдЬрдиреНрдорджрд┐рди рдХреА рд╣рд╛рд░реНрджрд┐рдХ рд╢реБрднрдХрд╛рдордирд╛рдпреЗ",
            'Pune': "рдореЛрдЗрд╡рд┐рдВрдЧ (MoEVing ) рдХреА рддрд░рдл рдЖрдкрдХреЛ рдЬрдиреНрдорджрд┐рди рдХреА рд╣рд╛рд░реНрджрд┐рдХ рд╢реБрднрдХрд╛рдордирд╛рдпреЗ",
            'Bengaluru': "MoEVing р▓Хр▓бр│Жр▓пр▓┐р▓Вр▓ж р▓╣р│Бр▓Яр│Нр▓Яр▓┐р▓жр▓╣р▓мр│Нр▓мр▓ж р▓╢р│Бр▓нр▓╛р▓╢р▓пр▓Чр▓│р│Б !",
            'Chennai': "MoEVing роЗроЯрооро┐ро░рпБроирпНродрпБ рокро┐ро▒роирпНродроиро╛ро│рпН ро╡ро╛ро┤рпНродрпНродрпБроХрпНроХро│рпН !",
            'Hyderabad': "MoEVing р░ир▒Бр░Вр░бр░┐ р░кр▒Бр░Яр▒Нр░Яр░┐р░ир░░р▒Лр░Ьр▒Б р░╢р▒Бр░нр░╛р░Хр░╛р░Вр░Хр▒Нр░╖р░▓р▒Б !",
            'Kolkata': "MoEVing (ржорзБржнрж┐ржВ)-ржПрж░ рждрж░ржл ржерзЗржХрзЗ ржЬржирзНржоржжрж┐ржирзЗрж░ ржЖржирзНрждрж░рж┐ржХ рж╢рзБржнрзЗржЪрзНржЫрж╛ !",
        }

        sms_language = {
            'Mumbai': "Hindi",
            'Gurgaon': "Hindi",
            'Delhi': "Hindi",
            'Noida': "Hindi",
            'Chandigarh': "Hindi",
            'Faridabad': "Hindi",
            'Lucknow': "Hindi",
            'Jaipur': "Hindi",
            'Ludhiana': "Hindi",
            'Patna': "Hindi",
            'Pune': "Hindi",
            'Bengaluru': "Kannada",
            'Chennai': "Tamil",
            'Hyderabad': "Telugu",
            'Kolkata': "Bengali",
        }

        city_sms_count = {}

        for user_id in user_ids:
            city_name = user_id[3]
            contact = user_id[1]
            user_id = user_id[0]

            if str(city_name) in sms_messages and str(city_name) in sms_headers:
                params = {
                    'send_to': contact,
                    'msg_type': 'Text',
                    'userid': 'userID',
                    'password': 'password',
                    'method': 'SendMessage',
                    'v': '1.1',
                    'format': 'json',
                    'msg': sms_messages[str(city_name)],
                    'header': sms_headers[str(city_name)],
                    'isTemplate': 'true'
                }
                response = requests.post(url, headers=headers, params=params)

                # Increment city-wise SMS count
                city_sms_count[city_name] = city_sms_count.get(city_name, 0) + 1 if response.status_code == 200 else 0

                if response.status_code == 200:
                    print(f"User ID: {user_id} - Response: {response.json()}")
                else:
                    print(f"User ID: {user_id} - Request failed with status code: {response.status_code}")

                time.sleep(1)

        # Print-city-wise SMS counts outside the loop
        for city_name, count in city_sms_count.items():
            # print(f"City: {city_name}, SMS Count: {count}")
            bot_message = {
                'text': f"Birthday wish message by Whatsapp Bot from MoEVing sent to {count} {city_name} Driver(s) in {sms_language[city_name]}."}

            print(bot_message['text'].replace('```', ''))

            message_headers = {'Content-Type': 'application/json; charset=UTF-8'}
            # Prod
            url = 'https://chat.googleapis.com/v1/spaces/AAAAl5asBn0/messages?key=-&token=x79cYsjotrl--'

            http_obj = Http()
            response = http_obj.request(
                uri=url,
                method='POST',
                headers=message_headers,
                body=dumps(bot_message),
            )

            conn.close()
